---
title: Ctrl-h再考 (モード別に専用の削除関数を割り当てる)
tags:
  - Emacs
  - emacs-lisp
  - Evil
  - DoomEmacs
  - vertico
private: false
updated_at: '2026-02-09T21:15:29+09:00'
id: 10e93c6e98ecd0a4299d
organization_url_name: null
slide: false
ignorePublish: false
---
## はじめに

Emacsの `Ctrl-h` にはもともと「ヘルプ」が割り当てられているが, Backspaceと同じ1文字削除に割り当て直すのが定番である.
以前は下記のようにグローバルで設定していた.

```emacs-lisp:~/.emacs.d/init.el
(global-set-key "\C-h" #'delete-backward-char)
```

しかしモードによっては, delete-char系の専用関数が用意されてる場合もあるため, 全モードで `delete-backward-char` にしてしまうのが微妙だった.

## Ctrl-h再考

今回 [Doom Emacs](https://github.com/doomemacs/doomemacs) の導入を機に, モードやステート別に `Ctrl-h` を割り当てるようにした.

```emacs-lisp:~/.doom.d/config.el
(map! :e
      "C-h" #'delete-backward-char ; Emacsステートではdelete-backward-charにしておく

      :map isearch-mode-map
      "C-h" #'isearch-delete-char ; インクリメンタルサーチ中の専用delete-char
      )

(setq! evil-want-C-h-delete t) ; insertステートでCtrl-hを1文字削除にする

(map! :after evil
      :map (
            evil-ex-completion-map
            evil-ex-search-keymap
            )
      "C-h" #'evil-ex-delete-backward-char ; exコマンドの専用delete-char
      )

;; デフォルトのvertico-directory-upが使いづらいので上書き
(map! :after vertico
      :map vertico-map
      "C-h" #'vertico-directory-delete-char
      )
```

## 参考: 各モード専用の delete-char 系の変数関数の説明

https://github.com/emacs-evil/evil/blob/1.14.2/evil-vars.el#L550-L551

https://github.com/emacs-evil/evil/blob/1.14.2/evil-ex.el#L219-L221

https://github.com/minad/vertico/blob/2.7/extensions/vertico-directory.el#L100-L101

https://www.gnu.org/software/emacs/manual/html_node/emacs/Basic-Isearch.html


## バージョン情報
```emacs-lisp
emacs-version => "30.2"
doom-version => "3.0.0-pre"
evil-version => "1.15.0"
```
