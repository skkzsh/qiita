---
title: AppleシリコンでもhombrewでインストールしたCライブラリのパスを通す
tags:
  - C
  - C++
  - homebrew
  - Makefile
  - AppleSilicon
private: false
updated_at: '2026-02-10T11:41:26+09:00'
id: 3af16ae3a97f131ee1ff
organization_url_name: null
slide: false
ignorePublish: false
---
## はじめに

homebrew でインストールしたCライブラリは`${HOMEBREW_PREFIX}/include` や `${HOMEBREW_PREFIX}/lib` にシンボリックリンクが張られる.

Intelでは `${HOMEBREW_PREFIX}` が `/usr/local` だったため, コンパイラのデフォルトでパスに入っていた.
しかしAppleシリコンでは `${HOMEBREW_PREFIX}` が `/opt/homebrew` のため, 自前でパスを追加する必要がある.

## 設定方法

コンパイル時のオプションで [`-I`](https://clang.llvm.org/docs/ClangCommandLineReference.html#cmdoption-clang-I-dir) や [`-L`](https://clang.llvm.org/docs/ClangCommandLineReference.html#cmdoption-clang-L-dir) を追加すればいいが,
毎回指定するのが煩雑な場合は [`CPATH`](https://clang.llvm.org/docs/CommandGuide/clang.html#envvar-CPATH) (または [`C_INCLUDE_PATH`, `CPLUS_INCLUDE_PATH`)](https://clang.llvm.org/docs/CommandGuide/clang.html#envvar-C_INCLUDE_PATH-OBJC_INCLUDE_PATH-CPLUS_INCLUDE_PATH-OBJCPLUS_INCLUDE_PATH) と [`LIBRARY_PATH`](https://gcc.gnu.org/onlinedocs/gcc/Environment-Variables.html#index-LIBRARY_005fPATH) に追加することもできる.

### 全体 (シェル) で設定する場合

下記のようにシェルで実行するか, `~/.zprofile` に書く.

```zsh
if [[ -d /opt/homebrew ]] ; then # ifの条件は適宜編集するか削除する
  export CPATH="/opt/homebrew/include:${CPATH}"
  export LIBRARY_PATH="/opt/homebrew/lib:${LIBRARY_PATH}"
fi
```

<details><summary> なお参考で <code>brew shellenv</code> はこうなっている.</summary>

```zsh
export HOMEBREW_PREFIX="/opt/homebrew";
export HOMEBREW_CELLAR="/opt/homebrew/Cellar";
export HOMEBREW_REPOSITORY="/opt/homebrew";
export PATH="/opt/homebrew/bin:/opt/homebrew/sbin${PATH+:$PATH}";
[ -z "${MANPATH-}" ] || export MANPATH=":${MANPATH#:}";
export INFOPATH="/opt/homebrew/share/info:${INFOPATH:-}";
```
</details>

また, 特定のCライブラリだけパスを通したい場合は, 下記のとおり.

```zsh
if [[ -d /opt/homebrew ]] ; then # ifの条件は適宜編集するか削除する
  export CPATH="$(brew --prefix googletest)/include:${CPATH}"
  export LIBRARY_PATH="$(brew --prefix googletest)/lib:${LIBRARY_PATH}"
fi
```

<details><summary> なおパスはこうなっている. </summary>

```console
$ ls -lhFG $(brew --prefix googletest)
lrwxr-xr-x@ 1 skkzsh  admin    27B  8 23 11:57 /opt/homebrew/opt/googletest@ -> ../Cellar/googletest/1.15.2

$ ls -1FG $(brew --prefix googletest)/
INSTALL_RECEIPT.json
LICENSE
README.md
include/
lib/
sbom.spdx.json

$ ls -1FG $(brew --prefix googletest)/include
gmock/
googlemock/
googletest/
gtest/

$ ls -1FG $(brew --prefix googletest)/lib
cmake/
libgmock.a
libgmock_main.a
libgtest.a
libgtest_main.a
pkgconfig/
```

</details>

### makeのときだけ設定する場合

`Makefile` に下記のように追加する.

```make:Makefile
ifeq ($(shell uname -p), arm)  # ifの条件は適宜編集するか削除する
    export CPATH := /opt/homebrew/opt/googletest/include:$(CPATH)
    export LIBRARY_PATH := /opt/homebrew/opt/googletest/lib:$(LIBRARY_PATH)
endif
```

### LSP (clangd) だけ設定する場合

下記のようなファイルを, プロジェクトルートに `.clangd` として置くか, OS全体に設定したい場合は`~/Library/Preferences/clangd/config.yaml` に置く.

```yaml:.clangdまたは~/Library/Preferences/clangd/config.yaml
CompileFlags:
  Add:
    - -I/opt/homebrew/opt/googletest/include
```

https://clangd.llvm.org/config#files

## 確認環境
```console
$ g++ -v
Apple clang version 15.0.0 (clang-1500.3.9.4)
Target: arm64-apple-darwin23.4.0
Thread model: posix
InstalledDir: /Library/Developer/CommandLineTools/usr/bin
```
